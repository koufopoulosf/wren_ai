# =============================================================================
# Wren AI Slack Bot - Environment Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Anthropic API (Claude Sonnet 4.5)
# -----------------------------------------------------------------------------
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-your-key-here

# Claude model to use (default: claude-sonnet-4-20250514)
ANTHROPIC_MODEL=claude-sonnet-4-20250514

# -----------------------------------------------------------------------------
# Slack Configuration
# -----------------------------------------------------------------------------
# Create a Slack app at: https://api.slack.com/apps
# Enable Socket Mode and create slash commands

# Bot token (starts with xoxb-)
SLACK_BOT_TOKEN=xoxb-your-bot-token

# App-level token (starts with xapp-)
SLACK_APP_TOKEN=xapp-your-app-token

# Signing secret from Slack app settings
SLACK_SIGNING_SECRET=your-signing-secret

# -----------------------------------------------------------------------------
# Wren AI Service
# -----------------------------------------------------------------------------
# URL of Wren AI service (default: http://wren-ai:8000 for docker-compose)
WREN_URL=http://wren-ai:8000

# Project ID (optional)
WREN_PROJECT_ID=analytics

# -----------------------------------------------------------------------------
# AWS Redshift Configuration
# -----------------------------------------------------------------------------
# Redshift cluster details
REDSHIFT_HOST=your-cluster.us-east-1.redshift.amazonaws.com
REDSHIFT_PORT=5439
REDSHIFT_DATABASE=analytics
REDSHIFT_USER=readonly_user
REDSHIFT_PASSWORD=your-password

# Enable SSL for Redshift connection (true/false)
DB_SSL=true

# -----------------------------------------------------------------------------
# User Roles & Access Control
# -----------------------------------------------------------------------------
# Format: SLACK_USER_ID:ROLE:DEPARTMENT
# Roles: admin, analyst
# Departments: all, sales, marketing, finance, engineering, etc.
#
# To get Slack user ID:
#   Right-click user in Slack → View profile → ⋯ More → Copy member ID
#
# Examples:
#   Admin (sees all data):        U01ABC123:admin:all
#   Sales analyst:                U02DEF456:analyst:sales
#   Marketing analyst:            U03GHI789:analyst:marketing
#
# Separate multiple users with commas:
USER_ROLES=U01ABC:admin:all,U02DEF:analyst:sales,U03GHI:analyst:marketing

# -----------------------------------------------------------------------------
# Department Access Rules
# -----------------------------------------------------------------------------
# Define which tables each department can access
# Use wildcards (*) for all tables in a schema
#
# Examples:
DEPT_ACCESS_SALES=public.orders,public.customers,public.products
DEPT_ACCESS_MARKETING=public.campaigns,public.leads,public.web_analytics
DEPT_ACCESS_FINANCE=public.*
DEPT_ACCESS_ENGINEERING=public.*,analytics.*

# -----------------------------------------------------------------------------
# Safety Limits
# -----------------------------------------------------------------------------
# Maximum query execution time (seconds)
MAX_QUERY_TIMEOUT_SECONDS=30

# Maximum rows to display in Slack (prevents huge messages)
MAX_ROWS_DISPLAY=50

# Maximum rows for CSV/JSON export
MAX_ROWS_EXPORT=10000

# -----------------------------------------------------------------------------
# Feature Toggles
# -----------------------------------------------------------------------------
# Enable/disable export formats
ENABLE_CSV_EXPORT=true
ENABLE_JSON_EXPORT=true
ENABLE_CHARTS=true

# Enable progressive clarification when confidence is low
ENABLE_PROGRESSIVE_CLARIFICATION=true

# Enable alternative question suggestions
ENABLE_ALTERNATIVE_SUGGESTIONS=true

# -----------------------------------------------------------------------------
# Confidence Thresholds
# -----------------------------------------------------------------------------
# High confidence: directly show SQL for approval (≥0.85)
CONFIDENCE_THRESHOLD_HIGH=0.85

# Low confidence: ask for clarification (<0.60)
CONFIDENCE_THRESHOLD_LOW=0.60

# Between thresholds: show SQL with warning

# -----------------------------------------------------------------------------
# Context Manager (Follow-up Questions)
# -----------------------------------------------------------------------------
# How long to keep query context for follow-up questions (minutes)
# After this time, "how about last month?" won't have context
CONTEXT_MAX_AGE_MINUTES=30

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# Maximum requests per time window (prevents spam)
RATE_LIMIT_MAX_REQUESTS=10

# Time window for rate limiting (minutes)
RATE_LIMIT_WINDOW_MINUTES=1

# Note: Admins bypass rate limiting

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Log file location (inside container)
LOG_FILE=/app/logs/wren-bot.log

# =============================================================================
# Optional: Development/Testing Settings
# =============================================================================

# Enable debug mode (more verbose logging)
# DEBUG=false

# Test mode (dry run without executing)
# TEST_MODE=false
